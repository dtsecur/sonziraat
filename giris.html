<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Siteye Giriş Sayısı</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
            margin: 0;
        }
        .counter {
            text-align: center;
        }
        .counter h1 {
            font-size: 2em;
        }
    </style>
</head>
<body>
    <div class="counter">
        <h1>Son 10 Dakikada Siteye Giriş Sayısı:</h1>
        <p id="visitCount">0</p>
    </div>

    <script>
        const STORAGE_KEY = 'visitTimestamps';
        const CHAT_ID = '-4238894331'; // Buraya Telegram Chat ID'nizi ekleyin
        const BOT_TOKEN = '7480749914:AAFXJ1h1HjVcblwoLul3vVCiztFvlAdchxw'; // Buraya Telegram Bot Token'inizi ekleyin

        function updateVisitCount() {
            const visitCountElement = document.getElementById('visitCount');
            
            let timestamps = JSON.parse(localStorage.getItem(STORAGE_KEY)) || [];
            const now = Date.now();
            const tenMinutesAgo = now - (10 * 60 * 1000);

            // Son 10 dakikadaki ziyaretleri filtrele
            timestamps = timestamps.filter(timestamp => timestamp > tenMinutesAgo);

            // Yeni bir ziyaret zaman damgası ekle
            timestamps.push(now);

            // Zaman damgalarını yerel depolamaya kaydet
            localStorage.setItem(STORAGE_KEY, JSON.stringify(timestamps));

            // Sayı göster
            visitCountElement.textContent = timestamps.length;

            // Ziyaret sayısını Telegram'a gönder
            sendVisitCountToTelegram(timestamps.length);
        }

        async function sendVisitCountToTelegram(count) {
            const message = `Son 10 dakika içerisinde siteye giren kişi sayısı: ${count}`;
            const url = `https://api.telegram.org/bot${BOT_TOKEN}/sendMessage`;

            try {
                const response = await fetch(url, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        chat_id: CHAT_ID,
                        text: message,
                    }),
                });

                if (!response.ok) {
                    console.error('Telegram mesajı gönderilirken hata oluştu:', response.statusText);
                }
            } catch (error) {
                console.error('Hata:', error);
            }
        }

        // Sayfa her yüklendiğinde veya her 10 dakikada bir güncelleme
        updateVisitCount();
        setInterval(updateVisitCount, 10 * 60 * 1000); // Her 10 dakikada bir
    </script>
</body>
</html>
